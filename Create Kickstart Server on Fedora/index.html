<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Create Kickstart Server on Fedora - Grant Curell's Dell Projects</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Create Kickstart Server on Fedora";
    var mkdocs_page_input_path = "Create Kickstart Server on Fedora/README.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Grant Curell's Dell Projects</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Grant Curell's Dell Projects</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Adding%20Hashing%20to%20OpenSwitch/">Adding Hashing to OpenSwitch</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Adding%20Intel%20I219-LM%20%288086.0d4c%29%20Driver%20to%20ESXi/">Adding Intel I219-LM (8086.0d4c) Driver to ESXi</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Automating%20OME%20Hardware%20Reports/">Automating OME Hardware Reports</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../CloudLink/">CloudLink</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Configure%20FN410%20as%20a%20Switch/">Configure FN410 as a Switch</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Configure%20Gigamon%20Tap/">Configure Gigamon Tap</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Configuring%20VLT%20on%20OS10/">Configuring VLT on OS10</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Create Kickstart Server on Fedora</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#files">Files</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#intro">Intro</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#useful-information">Useful Information</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#install-centos">Install CentOS</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#install-ansible-and-git">Install Ansible and git</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#disable-selinux">Disable SELinux</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#grab-image-files">Grab Image Files</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#clone-the-fedora-repositories">Clone the Fedora Repositories</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#clone-the-repo">Clone the Repo</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#configure-the-inventory-file">Configure the Inventory File</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#boot-drives">Boot Drives</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#running-the-code">Running the Code</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#critical-change-bios-settings">CRITICAL: Change BIOS Settings</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#optional-make-it-so-that-all-hosts-receive-dhcp">(Optional) Make it so that all hosts receive dhcp</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#make-the-repository-available-to-your-clients">Make the Repository Available to Your Clients</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#advanced">Advanced</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#importing-packages-from-another-system-minimally">Importing Packages from Another System Minimally</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#method-2-under-development">Method 2 - Under Development</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#info-on-the-kickstart-process">Info on the Kickstart Process</a>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Create%20OpenSwitch%20VM/">Create OpenSwitch VM</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Dell%20Ansible%20Testing/">Dell Ansible Testing</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../DHCP%20Relay%20on%20SONiC/">DHCP Relay on SONiC</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Elasticsearch%20Display%20Map%20Data/">Elasticsearch Display Map Data</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Elasticsearch%20Load%20Testing/">Elasticsearch Load Testing</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../esrally%20%28INCOMPLETE%29/">esrally (INCOMPLETE)</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Get%20NVMe%20Drives%20from%20iDRAC%20Redfish/">Get NVMe Drives from iDRAC Redfish</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../High%20Speed%20Packet%20Capture/">High Speed Packet Capture</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../How%20OS10%20Installer%20Works/">How OS10 Installer Works</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../How%20PCIe%20Works/">How PCIe Works</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../idrac%20with%20LDAP/">idrac with LDAP</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Importing%20Elasticsearch%20Data/">Importing Elasticsearch Data</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Installing%20DPDK%20with%20NapaTech%20Card/">Installing DPDK with NapaTech Card</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../IO%20Identities%20with%20LifeCycle%20Controller/">IO Identities with LifeCycle Controller</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../LDAP%20with%20OpenManage/">LDAP with OpenManage</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Load%20Balance%20Testing%20on%204112F-ON/OpenSwitch%20%28OPX%29/">Load Balancing with LAG OPX</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Load%20Balance%20Testing%20on%204112F-ON/OS10/">Load Balance Testing on 4112F-ON w/OS10</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Load%20Balance%20Testing%20with%20OpenVSwitch/">Load Balance Testing with OpenVSwitch</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Load%20Balancing%20on%20Mellanox%20Switches/">Load Balancing on Mellanox Switches</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Load%20Balancing%20with%20LAG%20on%205112F-ON/">Load Balancing with LAG on 5112F-ON</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Migrating%20Storage%20Volumes%20to%20PowerStore/">Migrating Storage Volumes to PowerStore</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Mulitple%20Span%20on%204112F-ON%20with%20OpenSwitch/">Mulitple Span on 4112F-ON with OpenSwitch</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Multiple%20Span%20on%204112F-ON%20with%20OS10/">Multiple Span on 4112F-ON with OS10</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Notes%20on%20HPC/">Notes on HPC</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Nvidia%20GPUDirect/">Nvidia GPUDirect</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Nvidia%20GRID%20Notes/">Nvidia GRID Notes</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../NVMe%20Performance%20Testing/">NVMe Performance Testing</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Offline%20Updates%20with%20OpenManage%20Enterprise/">Offline Updates with OpenManage Enterprise</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../OME%20Bug/">OME Bug</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../OME%20Integration%20for%20VMWare/">OME Integration for VMWare</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../OpenFlow%20on%204112F-ON/">OpenFlow on 4112F-ON</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../OS10%20Password%20Recovery%20Bug/">OS10 Password Recovery Bug</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../PCIev3%20vs%20v4/">PCIev3 vs v4</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Playing%20with%20virsh/">Playing with virsh</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Reset%20OS10%20Admin%20Password/">Reset OS10 Admin Password</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Run%20VPN%20on%20OS10/">Run VPN on OS10</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Running%20DNS%20from%20OS10/">Running DNS from OS10</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Sample%20Datacenter%20Automation%20Architecture/">Sample Datacenter Automation Architecture</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Set%20Up%20RSPAN%20on%20OS10/">Set Up RSPAN on OS10</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Setting%20Up%20Breakout%20Cables/">Setting Up Breakout Cables</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Setting%20Up%20iDRAC%20Telemetry%20with%20Splunk/">Setting Up iDRAC Telemetry with Splunk</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Setting%20Up%20SmartFabric%20Director/">Setting Up SmartFabric Director</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Setup%20IDPA/">Setup IDPA</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Site%20to%20Site%20VPN%20with%20PFSense%20and%20CentOS%208/">Site to Site VPN with PFSense and CentOS 8</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../SONiC%20-%20Fully%20Automated%20Build/">SONiC - Fully Automated Build</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Switch%20Directly%20to%20Client%20Test/">Switch Directly to Client Test</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Testing%20Intel%20x520%20on%20RHEL%206/">Testing Intel x520 on RHEL 6</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Understanding%20Memory/">Understanding Memory</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Use%20OS10%20as%20Aggregator/">Use OS10 as Aggregator</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Using%20the%20iDRAC%20Service%20Module/">Using the iDRAC Service Module</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../VEP%20Testing/">VEP Testing</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../VMWare/Automate%20ESXi%20Installation/">Automating ESXi Installation</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../VMWare/ESXi%20Architecture/">VMWare Architecture Notes</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../VMWare/Setup%20VXRail/">VxRail Setup</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../VMWare/Troubleshooting%20vSAN/">Troubleshooting vSAN</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../VMWare/VMWare%20APIs/">VMWare APIs</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../VMWare/VxRail%20Architecture%20and%20Troubleshooting/">VxRail Architecture and Troubleshooting</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../Web%20Traffic%20Generator/">Web Traffic Generator</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Grant Curell's Dell Projects</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Create Kickstart Server on Fedora</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>

          <div role="main">
            <div class="section">
              
                <h1 id="create-kickstart-server-on-fedora">Create Kickstart Server on Fedora</h1>
<h2 id="files">Files</h2>
<p>All files housed <a href="https://github.com/grantcurell/grantcurell.github.io/tree/master/docs/Create%20Kickstart%20Server%20on%20Fedora">here</a></p>
<h2 id="intro">Intro</h2>
<p>This Ansible playbook runs on CentOS. It will create a server which
allows you to install Fedora automatically via PXE boot and Kickstart.</p>
<p>For more information on Fedora's Kickstart capabilities see <a href="https://docs.fedoraproject.org/en-US/fedora/rawhide/install-guide/appendixes/Kickstart_Syntax_Reference/#appe-kickstart-syntax-reference">this link</a></p>
<h2 id="useful-information">Useful Information</h2>
<p><a href="https://docs.fedoraproject.org/en-US/fedora/rawhide/install-guide/advanced/Network_based_Installations/">How to set up Fedora Kickstart</a></p>
<p><a href="http://ftp.muug.mb.ca/pub/fedora/linux/releases/31/Everything/x86_64/os/Packages/">The Fedora Mirror I used</a></p>
<p>https://gist.github.com/andrewwippler/b636cdb68249ab5ffb67b4d8693a780b</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>Note: If you use a VM it will need at least 90GB of space.</p>
<h3 id="install-centos">Install CentOS</h3>
<p>You can download and install CentOS <a href="https://www.centos.org/download/">here</a></p>
<p>The installation services used by this program are very lightweight so you can
install on just about anything. A 12GB hard drive, 2GB RAM, and a single processor
are enough for what we are doing.</p>
<p>Go ahead and install CentOS on whatever you like, the only requirement is that
it must be reachable at layer 2 by the Fedora hosts you want to install.</p>
<h3 id="install-ansible-and-git">Install Ansible and git</h3>
<p>Before continuing you will need to install Ansible on your host by running <code>yum install -y ansible git</code>.</p>
<h3 id="disable-selinux">Disable SELinux</h3>
<p>Or set proper policies. Pick your poison. Since I only stood this thing up for as long as it took to kickstart I was
lazy and just disabled it. Sue me.</p>
<p><code>setenforce 0</code></p>
<p>I also updated this in <code>/etc/selniux/config</code>.</p>
<h3 id="grab-image-files">Grab Image Files</h3>
<p>You need to grab the image files for vmlinuz and initrd.img in order for Linux to boot properly. For Fedora grab them from
the below.</p>
<pre><code>wget https://download.fedoraproject.org/pub/fedora/linux/releases/31/Server/x86_64/os/images/pxeboot/vmlinuz -O /var/lib/tftpboot/vmlinuz
wget https://download.fedoraproject.org/pub/fedora/linux/releases/31/Server/x86_64/os/images/pxeboot/initrd.img -O /var/lib/tftpboot/initrd.img
wget http://fedora.mirrors.pair.com/linux/releases/31/Server/x86_64/os/images/install.img -O /var/www/html/iso/images/install.img
</code></pre>
<h3 id="clone-the-fedora-repositories">Clone the Fedora Repositories</h3>
<p>On a host of your choosing, run the following (update the 31 to the appropriate Fedora version):</p>
<pre><code>rsync http://ftp.muug.mb.ca/pub/fedora/linux/releases/31/Everything/x86_64/os/Packages/ /var/www/html/iso/Packages
</code></pre>
<p>Note: You will probably have to create the above directory.</p>
<p>You'll need 73 GB free to sync the packages. You will also need to grab the file in <a href="http://ftp.muug.mb.ca/pub/fedora/linux/releases/31/Everything/x86_64/os/repodata/">the repodata directory</a> called ending with comps.xml. You can see its exact name in repomd.xml.</p>
<p>Set it and forget it because it will be a bit while this all downloads. After you are downloading run:</p>
<pre><code>createrepo -g &lt;THE COMPS FILE YOU DOWNLOADED&gt; /var/www/html/iso/Packages
</code></pre>
<h3 id="clone-the-repo">Clone the Repo</h3>
<p>I typically use opt for optional programs. You may install wherever you like, but
in this guide I will use opt. Clone the repo with: <code>git clone https://github.com/grantcurell/Fedora-autoinstall.git</code></p>
<p>Move into the Fedora-autoinstall directory with <code>cd /opt/Fedora-autoinstall</code></p>
<h2 id="configure-the-inventory-file">Configure the Inventory File</h2>
<p>Ansible is controlled by what is called an inventory file. This inventory file contains
all the configuration settings which will be used by Ansible. In our case, we will
need to populate this with the settings we wish Fedora to have after installation.</p>
<p>The inventory file is called <em>inventory.yml</em></p>
<p>You will need to fill in the following values:</p>
<ul>
<li>dns</li>
<li>dhcp_start</li>
<li>dhcp_end</li>
<li>gateway</li>
<li>netmask</li>
<li>domain</li>
<li>root_password</li>
<li>server_ip</li>
<li>iso_fedora_pth</li>
<li>iso_fedora_checksum</li>
</ul>
<p>Finally you will also need to fill in the host information. These are the hosts on
which you would like to install Fedora. </p>
<h3 id="boot-drives">Boot Drives</h3>
<p>Most of the values are self explanatory however, boot_drive and data_drives may 
be a bit confusing. These options allow you to tell Ansible where to install Fedora
and on which disks to configure datastores. The official documentation on how Fedora
names drives is <a href="https://docs.vmware.com/en/VMware-vSphere/6.5/com.vmware.vsphere.install.doc/GUID-E7274FBA-CABC-43E8-BF74-2924FD3EFE1E.html">here</a>
The disks are in the order in which Fedora detects them. To get the order you may
have to manually install Fedora on a system. You can make an educated guess from
the BIOS menu or if you have something like iDrac you can look at the order of the
disks on the RAID controller (assuming you have one).</p>
<h2 id="running-the-code">Running the Code</h2>
<p>Once you are finished editing the <em>inventory.yml</em> file, <code>cd</code> to the root of the Fedora-autoinstall
directory and run <code>make</code>. This will run the makefile in the directory. You can
see what it is doing by examining the file called <em>Makefile</em></p>
<h2 id="critical-change-bios-settings">CRITICAL: Change BIOS Settings</h2>
<p>If you have NVMe drives and are trying to install Fedora, make sure you go into your BIOS and disable Intel Rapid Storage
Technology. If you do not, the NVMe drive will not appear and Anaconda will report that there are no disks available.</p>
<h3 id="optional-make-it-so-that-all-hosts-receive-dhcp">(Optional) Make it so that all hosts receive dhcp</h3>
<p>I intentionally left it set up so that only configured hosts would receive dhcpd to make sure no one nukes their network.
That said, if you want to make it so that all hosts receive dhcp edit <code>/etc/dhcp/dhcpd.conf</code> remove the line <code>deny unknown-clients</code>
and then add the line <code>filename "uefi/BOOTX64.EFI";</code> in the <code>subnet {}</code> directive. You will have to repeat this if you
run make again. After you are done, run <code>systemctl restart dhcpd</code></p>
<h2 id="make-the-repository-available-to-your-clients">Make the Repository Available to Your Clients</h2>
<p>Add a file called <code>local.repo</code> in <code>/etc/yum.repos.d/local.repo</code> with the following contents:</p>
<pre><code>[local]
name=Local
baseurl=http://192.168.1.121/iso/Packages
enabled=1
gpgcheck=0
</code></pre>
<h2 id="advanced">Advanced</h2>
<h3 id="importing-packages-from-another-system-minimally">Importing Packages from Another System Minimally</h3>
<h4 id="method-2-under-development">Method 2 - Under Development</h4>
<p>Say you want to create a new offline installer. What you'll have to do is go to a system that has all of the packages
you might want to use in your new image. You will then want to scrape all those packages so that you can then use them
on your new kickstart server. Do the following.</p>
<ol>
<li>On the system that already has the packages run: <code>dnf list installed | cut -d ' ' -f 1 | tr '\r\n' ' ' | sed s/Installed//g</code>.</li>
<li>The above command gets a list of all packages on the system and outputs them space separated. You could pipe that into xargs, but I prefer to do this next part manually in case there are any packages that don't work. Copy the output of the above and paste it as an argument to <code>dnf download --resolve &lt;YOUR_STUFF&gt;</code>. That will download all the packages on the server and their dependencies.</li>
<li>If any packages do not resolve you can run <code>dnf list installed | cut -d ' ' -f 1 | tr '\r\n' ' ' | sed s/Installed//g | sed s/&lt;PACKAGE_NAME_THAT_DIDNT_WORK&gt;//g</code> to omit it from the list.</li>
<li>After you run make on the Kickstart server to run the above command, go to <code>/var/www/html/iso/packages/</code> and copy all of the packages to that directory. You can use something like <code>scp * root@192.168.1.121:/var/www/html/iso/packages/</code> to do this.</li>
<li>When you are done, browse to your server using Chrome or something and make sure all the packages are available. Ex: http://192.168.1.121/iso/packages/</li>
</ol>
<h2 id="info-on-the-kickstart-process">Info on the Kickstart Process</h2>
<p>Kickstart has a lot of black magic going on. So below I give a high level overview of what's happening.</p>
<ol>
<li>Server boots and you tell it to boot with PXE.</li>
<li>
<p>PXE will then send out a DHCP request. The DHCP server that responds should be your kickstart server (typically) and it will have a few extra options set. Namely there should be a line that looks like the following:</p>
<pre><code># This line tell sth server to reach out over TFTP and grab the uefi/BOOTX64.EFI file. This file is a binary
# file which tells the server how to boot. It will be specific to your distro and you should generally get
# it from the ISO which you want to install. The path is a relative path against the TFTP root directory.
filename "uefi/BOOTX64.EFI";
</code></pre>
</li>
<li>
<p>Next, if you are doing UEFI, the server will search for a series of file names in the TFTP server's UEFI directory until it finds a boot menu profile that matches. I couldn't find documentation on it, but if you watch <code>/var/log/messages</code> you can actually see it try different as show below. It progresses through listed host MAC addresses first, then the IP address in hex format, and at the very end tries the default grub.cfg. To get maximum output you can add <code>server_args     = -s /var/lib/tftpboot --verbose</code> to <code>/etc/xinetd.d/tftp</code> assuming you are using xinetd to get this output.</p>
<pre><code>Jan 21 15:45:00 controller xinetd[10044]: START: tftp pid=10048 from=172.16.71.98
Jan 21 15:45:00 controller in.tftpd[10049]: RRQ from 172.16.71.98 filename uefi/BOOTX64.EFI
Jan 21 15:45:00 controller in.tftpd[10049]: Error code 8: User aborted the transfer
Jan 21 15:45:00 controller in.tftpd[10050]: RRQ from 172.16.71.98 filename uefi/BOOTX64.EFI
Jan 21 15:45:00 controller in.tftpd[10050]: Client 172.16.71.98 finished uefi/BOOTX64.EFI
Jan 21 15:45:00 controller in.tftpd[10051]: RRQ from 172.16.71.98 filename uefi/grubx64.efi
Jan 21 15:45:00 controller in.tftpd[10051]: Client 172.16.71.98 finished uefi/grubx64.efi
Jan 21 15:45:00 controller in.tftpd[10052]: RRQ from 172.16.71.98 filename /uefi/grub.cfg-01-00-50-56-86-d4-06
Jan 21 15:45:00 controller in.tftpd[10052]: Client 172.16.71.98 File not found /uefi/grub.cfg-01-00-50-56-86-d4-06
Jan 21 15:45:00 controller in.tftpd[10053]: RRQ from 172.16.71.98 filename /uefi/grub.cfg-AC104762
Jan 21 15:45:00 controller in.tftpd[10053]: Client 172.16.71.98 File not found /uefi/grub.cfg-AC104762
Jan 21 15:45:00 controller in.tftpd[10054]: RRQ from 172.16.71.98 filename /uefi/grub.cfg-AC10476
Jan 21 15:45:00 controller in.tftpd[10054]: Client 172.16.71.98 File not found /uefi/grub.cfg-AC10476
Jan 21 15:45:00 controller in.tftpd[10055]: RRQ from 172.16.71.98 filename /uefi/grub.cfg-AC1047
Jan 21 15:45:00 controller in.tftpd[10055]: Client 172.16.71.98 File not found /uefi/grub.cfg-AC1047
Jan 21 15:45:00 controller in.tftpd[10056]: RRQ from 172.16.71.98 filename /uefi/grub.cfg-AC104
Jan 21 15:45:00 controller in.tftpd[10056]: Client 172.16.71.98 File not found /uefi/grub.cfg-AC104
Jan 21 15:45:00 controller in.tftpd[10057]: RRQ from 172.16.71.98 filename /uefi/grub.cfg-AC10
Jan 21 15:45:00 controller in.tftpd[10057]: Client 172.16.71.98 File not found /uefi/grub.cfg-AC10
Jan 21 15:45:00 controller in.tftpd[10058]: RRQ from 172.16.71.98 filename /uefi/grub.cfg-AC1
Jan 21 15:45:00 controller in.tftpd[10058]: Client 172.16.71.98 File not found /uefi/grub.cfg-AC1
Jan 21 15:45:00 controller in.tftpd[10059]: RRQ from 172.16.71.98 filename /uefi/grub.cfg-AC
Jan 21 15:45:00 controller in.tftpd[10059]: Client 172.16.71.98 File not found /uefi/grub.cfg-AC
Jan 21 15:45:00 controller in.tftpd[10060]: RRQ from 172.16.71.98 filename /uefi/grub.cfg-A
Jan 21 15:45:00 controller in.tftpd[10060]: Client 172.16.71.98 File not found /uefi/grub.cfg-A
Jan 21 15:45:00 controller in.tftpd[10061]: RRQ from 172.16.71.98 filename /uefi/grub.cfg
Jan 21 15:45:00 controller in.tftpd[10061]: Client 172.16.71.98 finished /uefi/grub.cfg
Jan 21 15:45:00 controller in.tftpd[10062]: RRQ from 172.16.71.98 filename /EFI/BOOT/x86_64-efi/command.lst
Jan 21 15:45:00 controller in.tftpd[10062]: Client 172.16.71.98 File not found /EFI/BOOT/x86_64-efi/command.lst
Jan 21 15:45:00 controller in.tftpd[10063]: RRQ from 172.16.71.98 filename /EFI/BOOT/x86_64-efi/fs.lst
Jan 21 15:45:00 controller in.tftpd[10063]: Client 172.16.71.98 File not found /EFI/BOOT/x86_64-efi/fs.lst
Jan 21 15:45:00 controller in.tftpd[10064]: RRQ from 172.16.71.98 filename /EFI/BOOT/x86_64-efi/crypto.lst
Jan 21 15:45:00 controller in.tftpd[10064]: Client 172.16.71.98 File not found /EFI/BOOT/x86_64-efi/crypto.lst
Jan 21 15:45:00 controller in.tftpd[10065]: RRQ from 172.16.71.98 filename /EFI/BOOT/x86_64-efi/terminal.lst
Jan 21 15:45:00 controller in.tftpd[10065]: Client 172.16.71.98 File not found /EFI/BOOT/x86_64-efi/terminal.lst
Jan 21 15:45:00 controller in.tftpd[10066]: RRQ from 172.16.71.98 filename /uefi/grub.cfg
Jan 21 15:45:00 controller in.tftpd[10066]: Client 172.16.71.98 finished /uefi/grub.cfg
Jan 21 15:45:02 controller in.tftpd[10067]: RRQ from 172.16.71.98 filename /vmlinuz
Jan 21 15:45:03 controller in.tftpd[10067]: Client 172.16.71.98 finished /vmlinuz
Jan 21 15:45:03 controller in.tftpd[10068]: RRQ from 172.16.71.98 filename /initrd.img
Jan 21 15:45:08 controller in.tftpd[10068]: Client 172.16.71.98 finished /initrd.img
</code></pre>
</li>
<li>
<p>The boot menu profile (grub.cfg) looks like the below. The most important line is the linuxefi line. This line points to where your installation media should be hosted. Typically using httpd.</p>
<pre><code>set default="1"

function load_video {
insmod efi_gop
insmod efi_uga
insmod video_bochs
insmod video_cirrus
insmod all_video
}

load_video
set gfxpayload=keep
insmod gzio
insmod part_gpt
insmod ext2

set timeout=1
### END /etc/grub.d/00_header ###

### BEGIN /etc/grub.d/10_linux ###
menuentry 'Install Super Legit Fedora' --class fedora --class gnu-linux --class gnu --class os {
        echo "Loading vmlinuz"
        linuxefi vmlinuz inst.ks=http://192.168.2.101/ks/uefi/fedora.cfg inst.repo=http://192.168.1.121/iso/

        echo "Loading initrd.img"
        initrdefi initrd.img
}
</code></pre>
</li>
<li>
<p>The host in question will reach out and in this configuration grab a file called <code>install.img</code> located at /var/www/html/iso/images/ in this build. This file allows the host to boot and perform its other functions.</p>
</li>
</ol>
<p>TODO - finish this.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Create%20OpenSwitch%20VM/" class="btn btn-neutral float-right" title="Create OpenSwitch VM">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../Configuring%20VLT%20on%20OS10/" class="btn btn-neutral" title="Configuring VLT on OS10"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../Configuring%20VLT%20on%20OS10/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../Create%20OpenSwitch%20VM/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
